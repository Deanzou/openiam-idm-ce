use openiam;

-- delete wrong LDAP man_sys properties
DELETE FROM RESOURCE_PROP WHERE RESOURCE_PROP_ID = '223' AND RESOURCE_ID = '101' AND NAME = 'PRE_PROCESS'  AND ATTR_VALUE is null;
DELETE FROM RESOURCE_PROP WHERE RESOURCE_PROP_ID = '224' AND RESOURCE_ID = '101' AND NAME = 'POST_PROCESS' AND ATTR_VALUE is null;

-- delete unused default man sys rule for ad_win02 system
DELETE FROM MANAGED_SYS_RULE WHERE MANAGED_SYS_RULE_ID = 'ad_win02_managed_sys_rule_id';

-- fix Search Filter for LDAP and AD default configuration 
UPDATE MNG_SYS_OBJECT_MATCH set SEARCH_FILTER = '(&(objectclass=inetOrgPerson)(uid=?))' 
	WHERE OBJECT_SEARCH_ID = '101' AND MANAGED_SYS_ID = '101' AND OBJECT_TYPE = 'USER' AND KEY_FIELD = 'uid' AND SEARCH_FILTER = '(&(objectclass=inetOrgPerson)(?))';

UPDATE MNG_SYS_OBJECT_MATCH set SEARCH_FILTER = '(&(objectclass=user)(sAMAccountName=?))' 
	WHERE OBJECT_SEARCH_ID = '110' AND MANAGED_SYS_ID = '110' AND OBJECT_TYPE = 'USER' AND KEY_FIELD = 'CN' AND SEARCH_FILTER = '(&(objectclass=user)(?))';

UPDATE MANAGED_SYS SET ATTRIBUTE_NAMES_HNDLR = 'attribute-lookup/LDAPAttibuteNamesLookup.groovy' WHERE MANAGED_SYS_ID = '101' AND ATTRIBUTE_NAMES_HNDLR is null;

UPDATE MANAGED_SYS SET HNDLR_5 = 'LDAP' WHERE MANAGED_SYS_ID = '101' AND HNDLR_5 is null;

UPDATE MANAGED_SYS SET ATTRIBUTE_NAMES_HNDLR = 'attribute-lookup/ADAttibuteNamesLookup.groovy' WHERE MANAGED_SYS_ID = '110' AND ATTRIBUTE_NAMES_HNDLR is null;

UPDATE MANAGED_SYS SET HNDLR_5 = 'ACTIVE_DIRECTORY' WHERE MANAGED_SYS_ID = '110' AND HNDLR_5 is null;

UPDATE RECONCILIATION_CONFIG SET TARGET_SYS_SEARCH_FILTER = '(&(objectClass=user)(sAMAccountName=*))' WHERE RECON_CONFIG_ID = '110usertype' AND TARGET_SYS_SEARCH_FILTER = '(&(objectClass=user)(cn=*))';

UPDATE RECONCILIATION_CONFIG SET TARGET_SYS_MATCH_SCRIPT = 'recon/ADSearchQuery.groovy' WHERE RECON_CONFIG_ID = '110usertype' AND TARGET_SYS_MATCH_SCRIPT = 'recon/LDAPSearchQuery.groovy';

UPDATE RECONCILIATION_CONFIG SET MATCH_FIELD_NAME = 'MANAGED_SYS_PRINCIPAL' where RESOURCE_ID in ('101', '110', 'active_dir_win02_mng_sys_res_id') AND RECON_TYPE = 'USER';


DELETE FROM POLICY WHERE POLICY_ID = '4670';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('4670', '104', 'uid-principal', 'Open LDAP principal', 1, '3000', '','provision/uid_principal.groovy');
UPDATE RECON_RES_ATTR_MAP SET ATTR_POLICY_ID = '4670' WHERE RECON_RES_ATTR_MAP_ID = '14';

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '81';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('81','4515',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '531';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('531', '101', '101','USER', 'uid', '81', 'ACTIVE', 'STRING');

DELETE FROM POLICY WHERE POLICY_ID = '5670';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('5670', '104', 'ad-principal', 'AD principal', 1, '3000', '','provision/ad/ad_principal.groovy');
UPDATE RECON_RES_ATTR_MAP SET ATTR_POLICY_ID = '5670' WHERE RECON_RES_ATTR_MAP_ID = '30';

UPDATE ATTRIBUTE_MAP SET ATTRIBUTE_NAME = 'sAMAccountName' WHERE MAP_FOR_OBJECT_TYPE = 'PRINCIPAL' AND RESOURCE_ID='110';

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '80';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('80','4632',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '530';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('530', '110', '110','USER', 'CN', '80', 'ACTIVE', 'STRING');

UPDATE MANAGED_SYS SET ATTRIBUTE_NAMES_HNDLR = 'ADPowershell.ps1', RESUME_HNDLR = 'ADPowershell.ps1' WHERE MANAGED_SYS_ID = 'active_dir_win02_managed_sys_id';

UPDATE RECON_RES_ATTR_MAP SET ATTR_POLICY_ID = '5670' WHERE RECON_RES_ATTR_MAP_ID = '8a70a63f3f13d3e2013f13ecc1cc0004';

UPDATE ATTRIBUTE_MAP SET ATTRIBUTE_NAME = 'SamAccountName' WHERE ATTRIBUTE_POLICY_ID='8a70a63f3f13d3e2013f13ecc1cc0004';

UPDATE RECON_RES_ATTR_MAP SET ATTR_POLICY_ID='4547' WHERE RECON_RES_ATTR_MAP_ID = '8a70a63f3f5841b5013f5875860a0022';

UPDATE ATTRIBUTE_MAP SET ATTRIBUTE_NAME = 'Managers' WHERE ATTRIBUTE_POLICY_ID='8a70a63f3f1c34b4013f1ecf05ac02ab';


-- Adding group provisioning attributes

DELETE FROM POLICY WHERE POLICY_ID = '6600';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6600', '104', 'group-principal', 'LDAP group principal', 1, '3000', '','provision/group/ldap/cn_principal.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '82';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('82','6600',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '532';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('532', '101', '101','GROUP_PRINCIPAL', 'cn', '82', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6601';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6601', '104', 'group-objectclass', 'LDAP group objectclass', 1, '3000', '','provision/group/ldap/objectclass.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '83';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('83','6601',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '533';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('533', '101', '101','GROUP','objectClass', '83', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6602';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6602', '104', 'group-description', 'LDAP group description', 1, '3000', '','provision/group/ldap/description.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '84';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('84','6602',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '534';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('534', '101', '101','GROUP','description', '84', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6603';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6603', '104', 'group-ou', 'LDAP group path', 1, '3000', '','provision/group/ldap/ou.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '85';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('85','6603',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '535';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('535', '101', '101','GROUP','ou', '85', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6604';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6604', '104', 'group-uniqueMembers', 'LDAP group unique members', 1, '3000', '','provision/group/ldap/uniqueMembers.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '86';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('86','6604',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '536';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('536', '101', '101','GROUP','uniqueMember', '86', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6605';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6605', '104', 'ad-group-principal', 'AD group principal', 1, '3000', '','provision/group/ad/ad_principal.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '87';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('87','6605',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '537';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('537', '110', '110','GROUP_PRINCIPAL','sAMAccountName', '87', 'ACTIVE', 'STRING');

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '538';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('538', 'active_dir_win02_managed_sys_id', 'active_dir_win02_mng_sys_res_id','GROUP_PRINCIPAL','SamAccountName', '87', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6606';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6606', '104', 'ad-group-objectclass', 'AD group objectclass', 1, '3000', '','provision/group/ad/objectclass.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '88';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('88','6606',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '539';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('539', '110', '110','GROUP','objectClass', '88', 'ACTIVE', 'STRING');

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '540';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('540', 'active_dir_win02_managed_sys_id', 'active_dir_win02_mng_sys_res_id','GROUP','ObjectClass', '88', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6607';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6607', '104', 'ad-group-ou', 'AD group path', 1, '3000', '','provision/group/ad/ou.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '89';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('89','6607',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '541';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('541', '110', '110','GROUP','ou', '89', 'ACTIVE', 'STRING');

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '542';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('542', 'active_dir_win02_managed_sys_id', 'active_dir_win02_mng_sys_res_id','GROUP','Path', '89', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6608';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6608', '104', 'ad-group-description', 'AD group description', 1, '3000', '','provision/group/ad/description.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '90';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('90','6608',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '543';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('543', '110', '110','GROUP','description', '90', 'ACTIVE', 'STRING');

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '544';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('544', 'active_dir_win02_managed_sys_id', 'active_dir_win02_mng_sys_res_id','GROUP','Description', '90', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6609';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6609', '104', 'ad-group-sAMAccountName', 'AD group sAMAccountName', 1, '3000', '','provision/group/ad/sAMAccountName.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '91';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('91','6609',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '545';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('545', '110', '110','GROUP','sAMAccountName', '91', 'ACTIVE', 'STRING');

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '546';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('546', 'active_dir_win02_managed_sys_id', 'active_dir_win02_mng_sys_res_id','GROUP','SamAccountName', '91', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6610';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6610', '104', 'ad-group-name', 'AD group name', 1, '3000', '','provision/group/ad/name.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '92';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('92','6610',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '547';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('547', '110', '110','GROUP','name', '92', 'ACTIVE', 'STRING');

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '548';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('548', 'active_dir_win02_managed_sys_id', 'active_dir_win02_mng_sys_res_id','GROUP','Name', '92', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6611';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6611', '104', 'ad-group-members', 'AD group members', 1, '3000', '','provision/group/ad/members.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '93';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('93','6611',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '549';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('549', '110', '110','GROUP','member', '93', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6612';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6612', '104', 'ad-group-powershell-members', 'Powershell AD group members', 1, '3000', '','provision/group/ad/powershell_ad_members.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '95';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('95','6612',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '550';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('550', 'active_dir_win02_managed_sys_id', 'active_dir_win02_mng_sys_res_id','GROUP','Members', '95', 'ACTIVE', 'STRING');


DELETE FROM POLICY WHERE POLICY_ID = '6613';
INSERT INTO POLICY (POLICY_ID, POLICY_DEF_ID, NAME, DESCRIPTION, STATUS, CREATED_BY, RULE_TEXT, RULE_SRC_URL) VALUES
('6613', '104', 'ad-group-scope', 'AD group scope', 1, '3000', '','provision/group/ad/scope.groovy');

DELETE FROM RECON_RES_ATTR_MAP WHERE RECON_RES_ATTR_MAP_ID = '94';
INSERT INTO RECON_RES_ATTR_MAP (RECON_RES_ATTR_MAP_ID, ATTR_POLICY_ID, DEF_RECON_ATTR_MAP_ID) VALUES
('94','6613',NULL);

DELETE FROM ATTRIBUTE_MAP WHERE ATTRIBUTE_MAP_ID = '551';
INSERT INTO ATTRIBUTE_MAP(ATTRIBUTE_MAP_ID, MANAGED_SYS_ID, RESOURCE_ID, MAP_FOR_OBJECT_TYPE, ATTRIBUTE_NAME, ATTRIBUTE_POLICY_ID, STATUS, DATA_TYPE) VALUES ('551', 'active_dir_win02_managed_sys_id', 'active_dir_win02_mng_sys_res_id','GROUP','GroupScope', '94', 'ACTIVE', 'STRING');