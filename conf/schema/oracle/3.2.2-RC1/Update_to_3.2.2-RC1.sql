/********************** v 3.2.2 - RC1***********************/

/**********************dml/1.fix_language_mapping.sql***********************/

delete from LANGUAGE_MAPPING
where ID in ('DEMetadataTypeEntity10','DEMetadataTypeEntity20',
             'DEMetadataTypeEntity59','DEMetadataTypeEntity60',
			 'DEMetadataTypeEntity84',
             'ESMetadataTypeEntity10','ESMetadataTypeEntity20',
             'ESMetadataTypeEntity59','ESMetadataTypeEntity60',
			 'ESMetadataTypeEntity84',
             'RUMetadataTypeEntity82','RUMetadataTypeEntity83',
             'RUMetadataTypeEntity84','RUMetadataTypeEntity85',
             'RUMetadataTypeEntity87');

INSERT INTO LANGUAGE_MAPPING (ID,LANGUAGE_ID,REFERENCE_ID,REFERENCE_TYPE,TEXT_VALUE) VALUES ('RUABOUT_DESC','8','ABOUT','ResourceEntity.displayNameMap','Об OpenIAM');
INSERT INTO LANGUAGE_MAPPING (ID,LANGUAGE_ID,REFERENCE_ID,REFERENCE_TYPE,TEXT_VALUE) VALUES ('RUABOUT_ROOT_MENU_DESC','8','ABOUT_ROOT_MENU','ResourceEntity.displayNameMap','Об OpenIAM');
INSERT INTO LANGUAGE_MAPPING (ID,LANGUAGE_ID,REFERENCE_ID,REFERENCE_TYPE,TEXT_VALUE) VALUES ('RUSYNCUSER_REVIEW_DESC','8','SYNCUSER_REVIEW','ResourceEntity.displayNameMap','Проверка сихронизации');


/**********************dml/2.initial_cp_setup.sql***********************/
CREATE OR REPLACE PROCEDURE SETUP_CONTENT_PROVIDERS (cpDomain IN VARCHAR, serverDomain IN VARCHAR) AS
  cnt NUMBER := 0;
BEGIN 
  SELECT count(1) INTO cnt FROM CONTENT_PROVIDER;
  IF (cnt = 0) THEN
      INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC, URL) VALUES('DEFAULT_CP', 'CONTENT_PROVIDER', 'Default Content Provider', 'Y', CONCAT('http://', cpDomain, '/selfservice'));
			INSERT INTO CONTENT_PROVIDER (CONTENT_PROVIDER_ID, CONTENT_PROVIDER_NAME, IS_PUBLIC, DOMAIN_PATTERN, IS_SSL, RESOURCE_ID, MANAGED_SYS_ID) 
								   VALUES('DEFAULT_CP', 'Default Content Provider', 'Y', cpDomain, NULL, 'DEFAULT_CP', '0');
			INSERT INTO CP_AUTH_LEVEL_GRP_XREF (CONTENT_PROVIDER_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES ('DEFAULT_CP', 'PASSWORD_AUTH', 0);
			INSERT INTO CONTENT_PROVIDER_SERVER (CONTENT_PROVIDER_SERVER_ID, CONTENT_PROVIDER_ID, SERVER_URL) VALUES ('DEFAULT_CP', 'DEFAULT_CP', serverDomain);					   
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('DEF_CP_SELSERVICE_SLASH', 'URL_PATTERN', 'Default Content Provider /selfservice/*', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('DEF_CP_SELSERVICE_SLASH', 'DEFAULT_CP', '/selfservice/*', 'Y', 'DEF_CP_SELSERVICE_SLASH');
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('DEF_CP_WEBCONSOLE_AM_SLASH', 'URL_PATTERN', 'Default Content Provider /webconsole-am/*', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('DEF_CP_WEBCONSOLE_AM_SLASH', 'DEFAULT_CP', '/webconsole-am/*', 'Y', 'DEF_CP_WEBCONSOLE_AM_SLASH');
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('DEF_CP_WEBCONSOLE_IDM_SLASH', 'URL_PATTERN', 'Default Content Provider /webconsole-idm/*', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('DEF_CP_WEBCONSOLE_IDM_SLASH', 'DEFAULT_CP', '/webconsole-idm/*', 'Y', 'DEF_CP_WEBCONSOLE_IDM_SLASH');
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('DEF_CP_WEBCONSOLE_SLASH', 'URL_PATTERN', 'Default Content Provider /webconsole/*', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('DEF_CP_WEBCONSOLE_SLASH', 'DEFAULT_CP', '/webconsole/*', 'Y', 'DEF_CP_WEBCONSOLE_SLASH');
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('NEW_USER_TEMPLATE', 'UI_TEMPLATE', 'New User Template', 'Y');
			INSERT INTO METADATA_ELEMENT_PAGE_TEMPLATE (ID, NAME, RESOURCE_ID, IS_PUBLIC, TEMPLATE_TYPE_ID) VALUES('NEW_USER_TEMPLATE', 'New User Template', 'NEW_USER_TEMPLATE', 'Y', 'USER_TEMPLATE');
			INSERT INTO METADATA_URI_XREF (TEMPLATE_ID, URI_PATTERN_ID) VALUES('NEW_USER_TEMPLATE', 'DEF_CP_SELSERVICE_SLASH');
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('SELFREG_PATTERN', 'URL_PATTERN', 'Default Content Provider /selfservice/selfRegistration.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('SELFREG_PATTERN', 'DEFAULT_CP', '/selfservice/selfRegistration.html', 'Y', 'SELFREG_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('SELFREG_PATTERN', 'NONE', 0);
			INSERT INTO METADATA_URI_XREF (TEMPLATE_ID, URI_PATTERN_ID) VALUES('NEW_USER_TEMPLATE', 'SELFREG_PATTERN');
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('UI_STATIC', 'URL_PATTERN', 'Default Content Provider /openiam-ui-static/*', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('UI_STATIC', 'DEFAULT_CP', '/openiam-ui-static/*', 'Y', 'UI_STATIC');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('UI_STATIC', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('CHANGE_PASSWORD', 'URL_PATTERN', 'Default Content Provider /idp/changePassword.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('CHANGE_PASSWORD', 'DEFAULT_CP', '/idp/changePassword.html', 'Y', 'CHANGE_PASSWORD');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('CHANGE_PASSWORD', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('UNLOCK_PASSWORD', 'URL_PATTERN', 'Default Content Provider /idp/unlockPassword.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('UNLOCK_PASSWORD', 'DEFAULT_CP', '/idp/unlockPassword.html', 'Y', 'UNLOCK_PASSWORD');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('UNLOCK_PASSWORD', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('LOGOUT_PATTERN', 'URL_PATTERN', 'Default Content Provider /idp/logout.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('LOGOUT_PATTERN', 'DEFAULT_CP', '/idp/logout.html', 'Y', 'LOGOUT_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('LOGOUT_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('SAML_LOGIN_PATTERN', 'URL_PATTERN', 'Default Content Provider /idp/SAMLLogin.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('SAML_LOGIN_PATTERN', 'DEFAULT_CP', '/idp/SAMLLogin.html', 'Y', 'SAML_LOGIN_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('SAML_LOGIN_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('SAML_METADATA_PATTERN', 'URL_PATTERN', 'Default Content Provider /idp/SAMLMetadata.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('SAML_METADATA_PATTERN', 'DEFAULT_CP', '/idp/SAMLMetadata.html', 'Y', 'SAML_METADATA_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('SAML_METADATA_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('UNLOCK_PASSWORD_QUESTIONS', 'URL_PATTERN', 'Default Content Provider /idp/unlockPasswordQuestions.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('UNLOCK_PASSWORD_QUESTIONS', 'DEFAULT_CP', '/idp/unlockPasswordQuestions.html', 'Y', 'UNLOCK_PASSWORD_QUESTIONS');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('UNLOCK_PASSWORD_QUESTIONS', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('UNLOCK_USER_RESET_FORM', 'URL_PATTERN', 'Default Content Provider /idp/unlockUserResetPasswordForm.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('UNLOCK_USER_RESET_FORM', 'DEFAULT_CP', '/idp/unlockUserResetPasswordForm.html', 'Y', 'UNLOCK_USER_RESET_FORM');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('UNLOCK_USER_RESET_FORM', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('WEBCONSOLE_CLEAR_CNTX', 'URL_PATTERN', 'Default Content Provider /webconsole/clearContext.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('WEBCONSOLE_CLEAR_CNTX', 'DEFAULT_CP', '/webconsole/clearContext.html', 'Y', 'WEBCONSOLE_CLEAR_CNTX');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('WEBCONSOLE_CLEAR_CNTX', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('WEBCONSOLE_AM_CLEAR_CNTX', 'URL_PATTERN', 'Default Content Provider /webconsole-am/clearContext.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('WEBCONSOLE_AM_CLEAR_CNTX', 'DEFAULT_CP', '/webconsole-am/clearContext.html', 'Y', 'WEBCONSOLE_AM_CLEAR_CNTX');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('WEBCONSOLE_AM_CLEAR_CNTX', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('WEBCONSOLE_IDM_CLEAR_CNTX', 'URL_PATTERN', 'Default Content Provider /webconsole-idm/clearContext.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('WEBCONSOLE_IDM_CLEAR_CNTX', 'DEFAULT_CP', '/webconsole-idm/clearContext.html', 'Y', 'WEBCONSOLE_IDM_CLEAR_CNTX');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('WEBCONSOLE_IDM_CLEAR_CNTX', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('SELFSERVICE_CLEAR_CNTX', 'URL_PATTERN', 'Default Content Provider /selfservice/clearContext.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('SELFSERVICE_CLEAR_CNTX', 'DEFAULT_CP', '/selfservice/clearContext.html', 'Y', 'SELFSERVICE_CLEAR_CNTX');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('SELFSERVICE_CLEAR_CNTX', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('SELFSERVICE_EXT_CLEAR_CNTX', 'URL_PATTERN', 'Default Content Provider /selfservice-ext/clearContext.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('SELFSERVICE_EXT_CLEAR_CNTX', 'DEFAULT_CP', '/selfservice-ext/clearContext.html', 'Y', 'SELFSERVICE_EXT_CLEAR_CNTX');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('SELFSERVICE_EXT_CLEAR_CNTX', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('SEARCH_ORG_PATTERN', 'URL_PATTERN', 'Default Content Provider /selfservice/rest/api/entitlements/searchOrganizations', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('SEARCH_ORG_PATTERN', 'DEFAULT_CP', '/selfservice/rest/api/entitlements/searchOrganizations', 'Y', 'SEARCH_ORG_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('SEARCH_ORG_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('REPORTVIEWER_PATTERN', 'URL_PATTERN', 'Default Content Provider /reportviewer/*', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('REPORTVIEWER_PATTERN', 'DEFAULT_CP', '/reportviewer/*', 'Y', 'REPORTVIEWER_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('REPORTVIEWER_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('LANGUAGE_SUPPORT_PATTERN', 'URL_PATTERN', 'Default Content Provider /selfservice/language/languageSupport.html', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('LANGUAGE_SUPPORT_PATTERN', 'DEFAULT_CP', '/selfservice/language/languageSupport.html', 'Y', 'LANGUAGE_SUPPORT_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('LANGUAGE_SUPPORT_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('ROLE_METADATA_PATTERN', 'URL_PATTERN', 'Default Content Provider /selfservice/rest/api/metadata/roleMetadata', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('ROLE_METADATA_PATTERN', 'DEFAULT_CP', '/selfservice/rest/api/metadata/roleMetadata', 'Y', 'ROLE_METADATA_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('ROLE_METADATA_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('SEARCH_ROLES_PATTERN', 'URL_PATTERN', 'Default Content Provider /selfservice/rest/api/entitlements/searchRoles', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('SEARCH_ROLES_PATTERN', 'DEFAULT_CP', '/selfservice/rest/api/entitlements/searchRoles', 'Y', 'SEARCH_ROLES_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('SEARCH_ROLES_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('GROUP_METADATA_PATTERN', 'URL_PATTERN', 'Default Content Provider /selfservice/rest/api/metadata/groupMetadata', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('GROUP_METADATA_PATTERN', 'DEFAULT_CP', '/selfservice/rest/api/metadata/groupMetadata', 'Y', 'GROUP_METADATA_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('GROUP_METADATA_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('SEARCH_GROUPS_PATTERN', 'URL_PATTERN', 'Default Content Provider /selfservice/rest/api/entitlements/searchGroups', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('SEARCH_GROUPS_PATTERN', 'DEFAULT_CP', '/selfservice/rest/api/entitlements/searchGroups', 'Y', 'SEARCH_GROUPS_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('SEARCH_GROUPS_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('ORG_METADATA_PATTERN', 'URL_PATTERN', 'Default Content Provider /selfservice/rest/api/metadata/organizationMetadata', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('ORG_METADATA_PATTERN', 'DEFAULT_CP', '/selfservice/rest/api/metadata/organizationMetadata', 'Y', 'ORG_METADATA_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('ORG_METADATA_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('SP_PATTERN', 'URL_PATTERN', 'Default Content Provider /idp/sp/*', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('SP_PATTERN', 'DEFAULT_CP', '/idp/sp/*', 'Y', 'SP_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('SP_PATTERN', 'NONE', 0);
			
			INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, IS_PUBLIC) VALUES('PWD_VALIDATION_PATTERN', 'URL_PATTERN', 'Default Content Provider /idp/rest/api/password/validation/*', 'Y');
			INSERT INTO URI_PATTERN (URI_PATTERN_ID, CONTENT_PROVIDER_ID, PATTERN, IS_PUBLIC, RESOURCE_ID) VALUES('PWD_VALIDATION_PATTERN', 'DEFAULT_CP', '/idp/rest/api/password/validation/*', 'Y', 'SP_PATTERN');
			INSERT INTO URI_AUTH_LEVEL_GRP_XREF (URI_PATTERN_ID, AUTH_LEVEL_GROUPING_ID, EXEC_ORDER) VALUES('PWD_VALIDATION_PATTERN', 'NONE', 0);
  END IF;
END SETUP_CONTENT_PROVIDERS;
/


/**********************dml/3.self_report_menu_add.sql***********************/

DELETE FROM RESOURCE_GROUP WHERE RESOURCE_ID = 'SELF_REPORT_VIEWER';
DELETE FROM RESOURCE_USER WHERE RESOURCE_ID = 'SELF_REPORT_VIEWER';
DELETE FROM RESOURCE_ROLE WHERE RESOURCE_ID = 'SELF_REPORT_VIEWER';
DELETE FROM RESOURCE_PROP WHERE RESOURCE_ID = 'SELF_REPORT_VIEWER';
DELETE FROM res_to_res_membership WHERE MEMBER_RESOURCE_ID = 'SELF_REPORT_VIEWER';
DELETE FROM RES WHERE RESOURCE_ID = 'SELF_REPORT_VIEWER';
DELETE FROM LANGUAGE_MAPPING WHERE REFERENCE_ID='SELF_REPORT_VIEWER';

INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, NAME, DESCRIPTION, DISPLAY_ORDER, IS_PUBLIC, URL) 
	VALUES('SELF_REPORT_VIEWER', 'MENU_ITEM', 'SELF_REPORT_VIEWER', 'Report Viewer', 10, 'N', '/selfservice/report.html');

INSERT INTO RESOURCE_PROP (RESOURCE_PROP_ID, RESOURCE_ID, NAME, ATTR_VALUE) VALUES ('SELF_REPORT_VIEWER_PUB', 'SELF_REPORT_VIEWER', 'MENU_IS_PUBLIC', 'true');
INSERT INTO RESOURCE_PROP (RESOURCE_PROP_ID, RESOURCE_ID, NAME, ATTR_VALUE) VALUES ('SELF_REPORT_VIEWER_DESC', 'SELF_REPORT_VIEWER', 'MENU_DISPLAY_NAME', 'Report Viewer');

INSERT INTO res_to_res_membership (RESOURCE_ID, MEMBER_RESOURCE_ID) VALUES('SELFSERVICE_REPORT', 'SELF_REPORT_VIEWER');

DELETE FROM RESOURCE_ROLE WHERE ROLE_ID='9' and RESOURCE_ID='SELF_REPORT_VIEWER';
INSERT INTO RESOURCE_ROLE (ROLE_ID, RESOURCE_ID) VALUES('9', 'SELF_REPORT_VIEWER');

DELETE FROM LANGUAGE_MAPPING WHERE ID IN ('SELF_REPORT_VIEWER_DESC', 'DESELF_REPORT_VIEWER_DESC',
  'ESSELF_REPORT_VIEWER_DESC', 'RUSELF_REPORT_VIEWER_DESC', 'JPSELF_REPORT_VIEWER_DESC');

INSERT INTO LANGUAGE_MAPPING(ID, LANGUAGE_ID, REFERENCE_TYPE, REFERENCE_ID, TEXT_VALUE) VALUES ('SELF_REPORT_VIEWER_DESC', '1', 'ResourceEntity.displayNameMap', 'SELF_REPORT_VIEWER', 'Report Viewer');
INSERT INTO LANGUAGE_MAPPING(ID, LANGUAGE_ID, REFERENCE_TYPE, REFERENCE_ID, TEXT_VALUE) VALUES ('DESELF_REPORT_VIEWER_DESC', '2', 'ResourceEntity.displayNameMap', 'SELF_REPORT_VIEWER', 'Report Viewer');
INSERT INTO LANGUAGE_MAPPING(ID, LANGUAGE_ID, REFERENCE_TYPE, REFERENCE_ID, TEXT_VALUE) VALUES ('ESSELF_REPORT_VIEWER_DESC', '4', 'ResourceEntity.displayNameMap', 'SELF_REPORT_VIEWER', 'Report Viewer');
INSERT INTO LANGUAGE_MAPPING(ID, LANGUAGE_ID, REFERENCE_TYPE, REFERENCE_ID, TEXT_VALUE) VALUES ('RUSELF_REPORT_VIEWER_DESC', '8', 'ResourceEntity.displayNameMap', 'SELF_REPORT_VIEWER', 'Просмотрщик Отчетов');
INSERT INTO LANGUAGE_MAPPING(ID, LANGUAGE_ID, REFERENCE_TYPE, REFERENCE_ID, TEXT_VALUE) VALUES ('JPSELF_REPORT_VIEWER_DESC', '9', 'ResourceEntity.displayNameMap', 'SELF_REPORT_VIEWER', 'Report Viewer');

UPDATE RES SET DISPLAY_ORDER = 20 WHERE RESOURCE_ID = 'SUBSCRIBE';
UPDATE RES SET DISPLAY_ORDER = 30, DESCRIPTION = 'View Report Files' WHERE RESOURCE_ID = 'VIEW';

UPDATE LANGUAGE_MAPPING SET TEXT_VALUE = 'View Files' WHERE ID = 'VIEW_MENU_DESC';
UPDATE LANGUAGE_MAPPING SET TEXT_VALUE = 'Dateien anzeigen' WHERE ID = 'DEVIEW_MENU_DESC';
UPDATE LANGUAGE_MAPPING SET TEXT_VALUE = 'Ver archivos' WHERE ID = 'ESVIEW_MENU_DESC';
UPDATE LANGUAGE_MAPPING SET TEXT_VALUE = 'Просмотр Файлов' WHERE ID = 'RUVIEW_MENU_DESC';
UPDATE LANGUAGE_MAPPING SET TEXT_VALUE = 'ファイルの表示' WHERE ID = 'JPVIEW_MENU_DESC';


/**********************ddl/1.modify_report_info.sql/*********************************************/
ALTER TABLE REPORT_INFO ADD (RESOURCE_ID VARCHAR(32) NULL);
ALTER TABLE REPORT_INFO ADD CONSTRAINT REPORT_INFO_RES_FK FOREIGN KEY (RESOURCE_ID) REFERENCES RES(RESOURCE_ID);

/**********************dml/4.add_res_report.sql***********************/

DECLARE
 tCount NUMBER := 0;
BEGIN
  SELECT count(*) INTO tCount FROM RESOURCE_TYPE WHERE RESOURCE_TYPE_ID = 'REPORT';
  IF (tCount = 0) THEN
    INSERT INTO RESOURCE_TYPE (RESOURCE_TYPE_ID, DESCRIPTION, PROVISION_RESOURCE, PROCESS_NAME, SUPPORTS_HIERARCHY, SEARCHABLE, URL, IMAGE_TYPE)
				VALUES ('REPORT', 'Report', NULL, NULL, 'N', 'Y', 'iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAY9JREFUeNpiZC5lZgADRoY+IKnPQBy4yPCfoQjOE1NQYAitr0/7TyRgLmHeB8QMIMwINSPt7t27M+/du8cAwqmpqQz3n//AarWiFCcDazHLfiDTCUUioLIy8++/f////P2LF4PUMOcz7wdiBhDG6oLE5GSGh89/YneBNCcDez7rASDTEUXCo7Aw5xfQhh+/f+PFIDXMmcwHgJgBhLG6IDYhgeHhs19YXaAkx8XAmcl6EMh0QJFwSE8v+P7nz//PP37gxSA1TMlMB4GYAYSxuiA8Lo7hydPf2MNAnpOBN4X9MJBpB0k+UGAeG1uyZ+7c7t+/f+NNQaysrAz8iRxHgExbZANQXBAcHc3w5Mkf7GGgxMUgEItpAINuYGDFkRUr2n/+/InXBezs7AyCUZxHgUwbnC7wj4hgePrkL3YXKHMxCIdyHQMyrf+f+I+Q4NXVbf8EDOF3wJDGh0FqGO0YTzIKQuxmAWIhIJb6/POyHJ8Zyxmi8uIXhjsM7xl0gKxnIGM4QQ6AGkYKAIXyZ4AAAwDo2Ez5UkE+nAAAAABJRU5ErkJggg==', 'png');
  END IF;
END;
/

DECLARE
 tCount NUMBER := 0;
BEGIN
  SELECT count(*) INTO tCount FROM LANGUAGE_MAPPING WHERE ID = 'REPORT';
  IF (tCount = 0) THEN
    INSERT INTO LANGUAGE_MAPPING(ID, LANGUAGE_ID, REFERENCE_ID, REFERENCE_TYPE, TEXT_VALUE) VALUES  ('REPORT', '1', 'REPORT', 'ResourceTypeEntity.displayNameMap', 'Report');
	INSERT INTO LANGUAGE_MAPPING(ID, LANGUAGE_ID, REFERENCE_ID, REFERENCE_TYPE, TEXT_VALUE) VALUES ('DEREPORT', '2', 'REPORT', 'ResourceTypeEntity.displayNameMap', 'Bericht');
	INSERT INTO LANGUAGE_MAPPING(ID, LANGUAGE_ID, REFERENCE_ID, REFERENCE_TYPE, TEXT_VALUE) VALUES  ('ESREPORT', '4', 'REPORT', 'ResourceTypeEntity.displayNameMap', 'Informe');
	INSERT INTO LANGUAGE_MAPPING(ID, LANGUAGE_ID, REFERENCE_ID, REFERENCE_TYPE, TEXT_VALUE) VALUES  ('JPREPORT', '9', 'REPORT', 'ResourceTypeEntity.displayNameMap', '報告');
	INSERT INTO LANGUAGE_MAPPING(ID, LANGUAGE_ID, REFERENCE_ID, REFERENCE_TYPE, TEXT_VALUE) VALUES  ('RUREPORT', '8', 'REPORT', 'ResourceTypeEntity.displayNameMap', 'Отчет');
  END IF;
END;
/

DECLARE
 tCount NUMBER := 0;
BEGIN
  SELECT count(*) INTO tCount FROM RES WHERE RESOURCE_ID = 'USER_REPORT_101';
  IF (tCount = 0) THEN
	INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, DESCRIPTION, NAME, DISPLAY_ORDER, URL, MIN_AUTH_LEVEL, IS_PUBLIC,
			    ADMIN_RESOURCE_ID, RISK, TYPE_ID, COORELATED_NAME) VALUES ('USER_REPORT_101', 'REPORT', NULL, 'USER_REPORT_101', NULL, NULL, NULL, 'Y', NULL, NULL, NULL, 'USER_REPORT');
	INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, DESCRIPTION, NAME, DISPLAY_ORDER, URL, MIN_AUTH_LEVEL, IS_PUBLIC,
			    ADMIN_RESOURCE_ID, RISK, TYPE_ID, COORELATED_NAME) VALUES  ('AUDIT_REPORT_102', 'REPORT', NULL, 'AUDIT_REPORT_102', NULL, NULL, NULL, 'Y', NULL, NULL, NULL, 'AUDIT_REPORT');
	INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, DESCRIPTION, NAME, DISPLAY_ORDER, URL, MIN_AUTH_LEVEL, IS_PUBLIC,
			    ADMIN_RESOURCE_ID, RISK, TYPE_ID, COORELATED_NAME) VALUES  ('RECONCILIATION_REPORT_103', 'REPORT', NULL, 'RECONCILIATION_REPORT_103', NULL, NULL, NULL, 'Y', NULL, NULL, NULL, 'RECONCILIATION_REPORT');
	INSERT INTO RES (RESOURCE_ID, RESOURCE_TYPE_ID, DESCRIPTION, NAME, DISPLAY_ORDER, URL, MIN_AUTH_LEVEL, IS_PUBLIC,
			    ADMIN_RESOURCE_ID, RISK, TYPE_ID, COORELATED_NAME) VALUES ('SYNCHRONIZATION_REPORT_104', 'REPORT', NULL, 'SYNCHRONIZATION_REPORT_104', NULL, NULL, NULL, 'Y', NULL, NULL, NULL, 'SYNCHRONIZATION_REPORT');
  END IF;
END;
/


UPDATE REPORT_INFO SET RESOURCE_ID = 'USER_REPORT_101' WHERE REPORT_INFO_ID = '101';
UPDATE REPORT_INFO SET RESOURCE_ID = 'AUDIT_REPORT_102' WHERE REPORT_INFO_ID = '102';
UPDATE REPORT_INFO SET RESOURCE_ID = 'RECONCILIATION_REPORT_103' WHERE REPORT_INFO_ID = '103';
UPDATE REPORT_INFO SET RESOURCE_ID = 'SYNCHRONIZATION_REPORT_104' WHERE REPORT_INFO_ID = '104';


/**********************dml/5.hide_subscribe_menu.sql***********************/
DELETE FROM RESOURCE_ROLE WHERE RESOURCE_ID IN (
	'SELF_VIEW_REPORT_ROOT', 'VIEW', 'SELF_SUB_REPORT_NEW', 'SELF_SUB_REPORT_ROOT', 'SELF_VIEW_REPORT_NEW', 'SUBSCRIBE', 'SELF_REPORT_VIEWER');
DELETE FROM RESOURCE_GROUP WHERE RESOURCE_ID IN (
	'SELF_VIEW_REPORT_ROOT', 'VIEW', 'SELF_SUB_REPORT_NEW', 'SELF_SUB_REPORT_ROOT', 'SELF_VIEW_REPORT_NEW', 'SUBSCRIBE', 'SELF_REPORT_VIEWER');
DELETE FROM RESOURCE_USER WHERE RESOURCE_ID IN (
	'SELF_VIEW_REPORT_ROOT', 'VIEW', 'SELF_SUB_REPORT_NEW', 'SELF_SUB_REPORT_ROOT', 'SELF_VIEW_REPORT_NEW', 'SUBSCRIBE', 'SELF_REPORT_VIEWER');

UPDATE RES set IS_PUBLIC = 'N' WHERE RESOURCE_ID IN (
	'SELF_VIEW_REPORT_ROOT', 'VIEW', 'SELF_SUB_REPORT_NEW', 'SELF_SUB_REPORT_ROOT', 'SELF_VIEW_REPORT_NEW', 'SUBSCRIBE', 'SELF_REPORT_VIEWER', 'SELFSERVICE_REPORT');

UPDATE RES set URL = '/selfservice/report.html' WHERE RESOURCE_ID = 'SELFSERVICE_REPORT';
commit;
